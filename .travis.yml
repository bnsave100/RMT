language: java
install: true
script: mvn install -DskipTests=true -Dmaven.javadoc.skip=true -B -V
dist: trusty
jdk:
  - oraclejdk8
  - openjdk8

notification:
  email:
    - zhangjian12424@gmail.com
  on_success: never
  on_failure: always
deploy:
  provider: releases
  api_key: $GITHUB_TOKEN
  file: RELEASE/rmt-app.jar
  skip_cleanup: true
  on:
    tags: true

services: docker
sudo: required
before_install:
  - docker build -t helixcs/rmt .
after_success:
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - docker push helixcs/rmt:latest